Patients Table
primary key icon	patient_id	INT
first_name	TEXT
last_name	TEXT
gender	CHAR(1)
birth_date	DATE
city	TEXT
primary key icon	province_id	CHAR(2)
allergies	TEXT
height	INT
weight	INT

ADMISSIONS Table
primary key icon	patient_id	INT
admission_date	DATE
discharge_date	DATE
diagnosis	TEXT
primary key icon	attending_doctor_id	INT



SELECT * FROM patients;

select first_name,last_name,gender from patients where gender='M';

select first_name,last_name from patients where allergies is null;

select first_name from patients where first_name like 'C%';

select first_name,last_name from patients where weight between 100 and 120;

update patients set allergies='NKA' where allergies is null;

SELECT DISTINCT EXTRACT(YEAR FROM birth_date) AS birth_year

SELECT DISTINCT YEAR(birth_date) AS birth_year FROM patients ORDER BY birth_year;

SELECT first_name FROM patients GROUP BY first_name HAVING COUNT(*) = 1;

select patient_id,first_name from patients where first_name 
like('S%s') and length(first_name)>=6;

select p.patient_id,p.first_name,p.last_name from patients p inner join admissions a
on p.patient_id=a.patient_id where a.diagnosis='Dementia';

SELECT first_name
FROM patients
ORDER BY LENGTH(first_name), first_name;

SELECT * FROM patients
select sum(case when gender='M' then 1 else 0 end) as 'male_count',
sum(case when gender='F' then 1 else 0 end) as 'female_count' from patients;

select first_name,last_name,allergies from patients where allergies 
in ('Pencillin','Morphine') order by allergies,first_name,last_name;

SELECT patient_id, diagnosis FROM admission GROUP BY patient_id, diagnosis
HAVING COUNT(*) > 1;

select city,count(*) as 'num_patients' from patients group by city
order by num_patients desc,city asc;

SELECT first_name, last_name, 'Patient' as role FROM patients union all
select first_name, last_name, 'Doctor' from doctors; 

SELECT allergies,COUNT(*) AS allergy_count FROM patients WHERE allergies IS NOT NULL
GROUP BY allergies ORDER BY allergy_count DESC;

select first_name,last_name,birth_date from patients where year(birth_date)
between 1970 and 1979 order by birth_date;

select concat(upper(last_name),',',lower(first_name)) as 'new_name_format'
from patients order by first_name desc;

select province_id,sum(height) as 'sum_height'from patients group by province_id
having sum(height)>=7000;

select max(weight)-min(weight) as 'weighted_data' from patients where 
last_name='Maroni';

SELECT DAY(admission_date) AS day_number,COUNT(*) AS number_of_admissions FROM admissions
GROUP BY day_number ORDER BY number_of_admissions DESC

SELECT patient_id,admission_date,discharge_date,diagnosis,attending_doctor_id
FROM admissions where patient_id=542 ORDER BY admission_date DESC limit 1;

SELECT *
FROM admissions
WHERE
  patient_id = '542'
  AND admission_date = (
    SELECT MAX(admission_date)
    FROM admissions
    WHERE patient_id = '542'
  )
/* Show patient_id, attending_doctor_id, and diagnosis for admissions that match one of the two criteria:
1. patient_id is an odd number and attending_doctor_id is either 1, 5, or 19.
2. attending_doctor_id contains a 2 and the length of patient_id is 3 characters.*/ 
  SELECT
  patient_id,
  attending_doctor_id,
  diagnosis
FROM admissions
WHERE
  (
    attending_doctor_id IN (1, 5, 19)
    AND patient_id % 2 != 0
  )
  OR 
  (
    attending_doctor_id LIKE '%2%'
    AND len(patient_id) = 3
  )







                                                                       


